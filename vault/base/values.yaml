# HashiCorp Vault Helm Chart - Base Values
# Reference: https://github.com/hashicorp/vault-helm
# These are common defaults; overlays can override for specific environments

global:
  enabled: true
  tlsDisable: true  # Override to false in production with proper TLS

# Injector Configuration - Sidecar for injecting secrets into pods
# Disabled by default when using ArgoCD Vault Plugin (AVP)
injector:
  enabled: false

# Vault Server Configuration
server:
  enabled: true
  
  # Image configuration
  image:
    repository: "hashicorp/vault"
    tag: "1.15.4"
    pullPolicy: IfNotPresent
  
  # Update strategy
  updateStrategyType: "OnDelete"
  
  # Resource limits - conservative defaults
  resources:
    requests:
      memory: 256Mi
      cpu: 250m
    limits:
      memory: 512Mi
      cpu: 500m
  
  # Readiness probe
  readinessProbe:
    enabled: true
    path: "/v1/sys/health?standbyok=true&sealedcode=204&uninitcode=204"
  
  # Liveness probe
  livenessProbe:
    enabled: true
    path: "/v1/sys/health?standbyok=true"
    initialDelaySeconds: 60
  
  # Vault service
  service:
    enabled: true
    type: ClusterIP
    port: 8200
    targetPort: 8200
  
  # Data storage - disabled by default, use hostPath or PVC in overlays
  dataStorage:
    enabled: false
  
  # Audit storage - disabled, use external log shipping
  auditStorage:
    enabled: false
  
  # Standalone mode - default configuration
  standalone:
    enabled: true
    config: |
      ui = true
      
      listener "tcp" {
        tls_disable = 1
        address = "[::]:8200"
        cluster_address = "[::]:8201"
        telemetry {
          unauthenticated_metrics_access = true
        }
      }
      
      storage "file" {
        path = "/vault/data"
      }
      
      telemetry {
        prometheus_retention_time = "30s"
        disable_hostname = true
      }
  
  # HA mode - disabled by default
  ha:
    enabled: false
    replicas: 3
    raft:
      enabled: true
      setNodeId: true

# Vault UI
ui:
  enabled: true
  serviceType: ClusterIP
  externalPort: 8200

# CSI Provider - disabled by default
csi:
  enabled: false

# Server Service Account
serverServiceAccount:
  create: true
  name: vault
  annotations: {}
